{"revisions":{"1338198880339":{"ts":1338198880339,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n  <script type=\"text/javascript\" src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js\">\n  </script>\n    <meta charset=\"utf-8\">\n    <title>Chat Server </title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"author\" content=\"\">\n    \n    <script type=\"text/javascript\">\n\n  var _gaq = _gaq || [];\n  _gaq.push(['_setAccount', 'UA-32151073-1']);\n  _gaq.push(['_trackPageview']);\n\n  (function() {\n    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;\n    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';\n    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);\n  })();\n\n</script>\n    \n    <!-- Le styles -->\n    <link href=\"stylesheets/bootstrap.css\" rel=\"stylesheet\">\n    <style>\n      body {\n        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */\n      }\n    </style>\n    <link href=\"stylesheets/bootstrap-responsive.css\" rel=\"stylesheet\">\n\n    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->\n    <!--[if lt IE 9]>\n      <script src=\"http://html5shim.googlecode.com/svn/trunk/html5.js\"></script>\n    <![endif]-->\n\n    <!-- Le fav and touch icons -->\n    <link rel=\"shortcut icon\" href=\"../assets/ico/favicon.ico\">\n    <link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"../assets/ico/apple-touch-icon-114-precomposed.png\">\n    <link rel=\"apple-touch-icon-precomposed\" sizes=\"72x72\" href=\"../assets/ico/apple-touch-icon-72-precomposed.png\">\n    <link rel=\"apple-touch-icon-precomposed\" href=\"../assets/ico/apple-touch-icon-57-precomposed.png\">\n  </head>\n\n  <body>\n\n    <div class=\"navbar navbar-fixed-top\">\n      <div class=\"navbar-inner\">\n        <div class=\"container\">\n          <a class=\"btn btn-navbar\" data-toggle=\"collapse\" data-target=\".nav-collapse\">\n            <span class=\"icon-bar\"></span>\n            <span class=\"icon-bar\"></span>\n            <span class=\"icon-bar\"></span>\n          </a>\n          <a class=\"brand\" href=\"#\">Lets Chat</a>\n\n        </div>\n      </div>\n    </div>\n\n   <div class=\"container-fluid\">\n     <div class=\"row-fluid\">\n       <div class=\"span10\">\n         <!--Body content-->\n         \n         <div id=\"livechat\" class=\"well\" style=\"min-height:460px;\n\">\n         \n   \n           \n           \n         \n         </div>\n         \n       </div>\n       \n       <div class=\"span2\">\n         <!--Sidebar content-->\n       \t\n       \t<div id=\"users_online\">\n       \t<ul id=\"online\">\n     \n       \t</ul>\n       \t</div>\n       \n       </div>\n       \n       \n     </div>\n   </div> <!-- /container -->\n\n<div class=\"navbar navbar-fixed-bottom\">\n<div class=\"navbar-inner\">\n<div class=\"container\">\n<a class=\"brand\"></a>\n<form class=\"navbar-form\">\n\n\n<input type=\"text\" id=\"username\" placeholder=\"Enter username\" style=\"margin-bottom: 3px;\" />\n\n\n<input class=\"span8\" type=\"text\" id=\"message\" placeholder=\"Be nice\" style=\"margin-bottom: 3px;\" />\n<input class=\"btn btn-primary span2\" type=\"button\" id=\"send\" value=\"Send\" />\n</form>\n</div>\n</div>\n</div>\n\n    <!-- Le javascript\n    ================================================== -->\n    <!-- Placed at the end of the document so the pages load faster -->\n    <script src=\"javascript/jquery.js\"></script>\n    <script src=\"javascript/bootstrap-transition.js\"></script>\n    <script src=\"javascript/bootstrap-alert.js\"></script>\n    <script src=\"javascript/bootstrap-modal.js\"></script>\n    <script src=\"javascript/bootstrap-dropdown.js\"></script>\n    <script src=\"javascript/bootstrap-scrollspy.js\"></script>\n    <script src=\"javascript/bootstrap-tab.js\"></script>\n    <script src=\"javascript/bootstrap-tooltip.js\"></script>\n    <script src=\"javascript/bootstrap-popover.js\"></script>\n    <script src=\"javascript/bootstrap-button.js\"></script>\n    <script src=\"javascript/bootstrap-collapse.js\"></script>\n    <script src=\"javascript/bootstrap-carousel.js\"></script>\n    <script src=\"javascript/bootstrap-typeahead.js\"></script>\n    <script src=\"/socket.io/socket.io.js\"></script>\n    \n    <script>\n    var user = null;\n    $(function () {\n    \n   \n    \n    \tvar socket = io.connect(document.location.origin);\n    \t\n    \tsocket.on('news', function (data) {\n      \tconsole.log(data);\n     \t});\n     \t\n     \t//check weather username is stored in the session, if yes then directly authenticate the user\n     \tif(sessionStorage.username != undefined)\n     \t{\n     \t\t$('#username').hide(sessionStorage.username);\n     \t\t$('.brand').html();\n     \t\t$('.brand').show();\n     \t\t$(\"#message\").show();\n     \t\t$(\"#message\").focus();\n     \t\tsocket.emit('adduser', sessionStorage.username);\n     \t}\n     \telse {\n\t\t//hiding the brand\n\t\t$('.brand').hide();\n\t\t$('#message').hide();\n\t\t$(\"#username\").focus();\n\t\t\n\t\t}\t\n     \t\n     \tfunction addUser() {\n     \t\tif($('#username').val() != \"\")\n     \t\t{\n     \t\t\tvar usr = $('#username').val();\n     \t\t\tvar safe = usr.replace(/&/g, '&amp;').replace(/</g, '&lt;')\n     \t\t\t                      .replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n     \t\t\tsessionStorage.username = safe;\n     \t\t\tsocket.emit('adduser', sessionStorage.username);\n     \t\t}\n     \t\treturn;\n     \t}\n     \t\n     \t$(\"#send\").click(\n     \tfunction() {\n     \tconsole.log(\"Send pressed\");\n     \t//check if username is null if yes then fire addUsername event and send the username\n     \tif(sessionStorage.username === undefined)\n     \t{\n     \t\taddUser();\n     \t\treturn;\n     \t}\n     \t\n     \t//handle message send\n     \tvar msg = $('#message').val();\n     \tif(msg != \"\")\n     \t{\n     \t\tvar safe = msg.replace(/&/g, '&amp;').replace(/</g, '&lt;')\n     \t\t                      .replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n     \t\tconsole.log(\"message is not null\");\n     \t\tsocket.emit('message', {message: safe, user: sessionStorage.username, timestamp: new Date()}); \n     \t}\n     \t});\n     \t\n     \t//handle enter key event on username textbox\n     \t$('#username').keydown(function (e) {\n     \t\tif(e.which === 13)\n     \t\t{\n     \t\t\taddUser();\n     \t\t}\n     \t});\n     \t\n     \t//handle enter key event on messagebox\n     \t$(\"#message\").keydown(function (e) {\n     \tif(e.which === 13)\n     \t{\n     \t\t//handle message send\n     \t\tvar msg = $('#message').val();\n     \t\t$('#message').val('');\n     \t\tif(msg != \"\")\n     \t\t{\n     \t\t\tvar safe = msg.replace(/&/g, '&amp;').replace(/</g, '&lt;')\n     \t\t\t                      .replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n     \t\t\tconsole.log(\"message is not null\");\n     \t\t\tsocket.emit('message', {message: safe, user: user, timestamp: new Date()}); \n     \t\t}\n     \t}\n     \t});\n     \t\n     \tsocket.on('userAdded', function(data) {\n     \t//add banner containing the username\n     \t$('#username').hide();\n     \t$('.brand').html(data.username);\n     \t$('.brand').show();\n     \t$(\"#message\").show();\n     \t$(\"#message\").focus();\n     \tuser = data.username;\n     \t});\n     \t\n     \tsocket.on('updateUsers', function (data) {\n     \tif(data != null)\n     \t{\n     \t\t$('#online').html(\"\");\n     \t\tfor(var key in data.usernames)\n     \t\t{\n     \t\t\t//add the user to the list of online users\n     \t\t\t$('#online').append(\"<li>\"+key+\"</li>\");\n     \t\t}\n     \t}\n     \t\n     \t}); \n     \n     //load history\n     socket.on('loadHistory', function(data) {\n     \n     for(var i=0; i<data.length; i++)\n     {\n     \t\tvar html = \"<div class='post-other'> <div class='post-inner'><b>\"\n     \t\t+ data[i].user + \"</b> \"+ data[i].message + \"</div></div>\";\n     \t\t\n     \t\t$('#livechat').append(html);\n     }\n     });\n     \n     socket.on('update',function (data) {\n     console.log(\"updatechat called\");\n     \tif(data.user === user)\n     \t{\n     \t\tvar html = \"<div class='post-current'> <div class='post-inner'><b>\"\n     \t\t+ data.user + \"</b> \"+ data.message + \"</div></div>\";\n     \t\t\n     \t\t$('#livechat').append(html);\n     \t\t\n     \t} else {\n     \t\n     \t\tvar html = \"<div class='post-other'> <div class='post-inner'><b>\"\n     \t\t+ data.user + \"</b> \"+ data.message + \"</div></div>\";\n     \t\t\n     \t\t$('#livechat').append(html);\n     \t}\n     \t\n     });\n     \n    \n   \n     \n   });\n   \n\t\n    </script>\n\n  </body>\n</html>\n"]],"start1":0,"start2":0,"length1":0,"length2":8233}]],"length":8233}}}